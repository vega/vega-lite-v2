{"version":3,"file":"multi.test.js","sourceRoot":"","sources":["../../../../test/compile/selection/multi.test.ts"],"names":[],"mappings":"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","sourcesContent":["/* tslint:disable quotemark */\nimport {assert} from 'chai';\n\nimport multi from '../../../src/compile/selection/multi';\nimport * as selection from '../../../src/compile/selection/selection';\nimport {parseUnitModelWithScale} from '../../util';\n\ndescribe('Multi Selection', function() {\n  const model = parseUnitModelWithScale({\n    \"mark\": \"circle\",\n    \"encoding\": {\n      \"x\": {\"field\": \"Horsepower\",\"type\": \"quantitative\"},\n      \"y\": {\"field\": \"Miles_per_Gallon\",\"type\": \"quantitative\", \"bin\": true},\n      \"color\": {\"field\": \"Origin\", \"type\": \"nominal\"}\n    }\n  });\n\n  const selCmpts = model.component.selection = selection.parseUnitSelection(model, {\n    \"one\": {\"type\": \"multi\"},\n    \"two\": {\n      \"type\": \"multi\", \"nearest\": true,\n      \"on\": \"mouseover\", \"toggle\": \"event.ctrlKey\", \"encodings\": [\"y\", \"color\"]\n    }\n  });\n\n  it('builds tuple signals', function() {\n    const oneSg = multi.signals(model, selCmpts['one']);\n    assert.sameDeepMembers(oneSg, [{\n      name: 'one_tuple',\n      value: {},\n      on: [{\n        events: selCmpts['one'].events,\n        update: \"datum && item().mark.marktype !== 'group' ? {unit: \\\"\\\", encodings: [], fields: [\\\"_vgsid_\\\"], values: [datum[\\\"_vgsid_\\\"]]} : null\",\n        force: true\n      }]\n    }]);\n\n    const twoSg = multi.signals(model, selCmpts['two']);\n    assert.sameDeepMembers(twoSg, [{\n      name: 'two_tuple',\n      value: {},\n      on: [{\n        events: selCmpts['two'].events,\n        update: \"datum && item().mark.marktype !== 'group' ? {unit: \\\"\\\", encodings: [\\\"y\\\", \\\"color\\\"], fields: [\\\"Miles_per_Gallon\\\", \\\"Origin\\\"], values: [[(item().isVoronoi ? datum.datum : datum)[\\\"bin_maxbins_10_Miles_per_Gallon\\\"], (item().isVoronoi ? datum.datum : datum)[\\\"bin_maxbins_10_Miles_per_Gallon_end\\\"]], (item().isVoronoi ? datum.datum : datum)[\\\"Origin\\\"]], \\\"bin_Miles_per_Gallon\\\": 1} : null\",\n        force: true\n      }]\n    }]);\n\n    const signals = selection.assembleUnitSelectionSignals(model, []);\n    assert.includeDeepMembers(signals, oneSg.concat(twoSg));\n  });\n\n  it('builds unit datasets', function() {\n    const data: any[] = [];\n    assert.sameDeepMembers(selection.assembleUnitSelectionData(model, data), [\n      {name: 'one_store'}, {name: 'two_store'}\n    ]);\n  });\n\n  it('leaves marks alone', function() {\n    const marks: any[] = [];\n    model.component.selection = {one: selCmpts['one']};\n    assert.equal(selection.assembleUnitSelectionMarks(model, marks), marks);\n  });\n});\n"]}
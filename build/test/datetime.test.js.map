{"version":3,"file":"datetime.test.js","sourceRoot":"","sources":["../../test/datetime.test.ts"],"names":[],"mappings":"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","sourcesContent":["import {assert} from 'chai';\nimport {dateTimeExpr} from '../src/datetime';\nimport * as log from '../src/log';\n\ndescribe('datetime', () => {\n  describe('dateTimeExpr', () => {\n    it('should drop day if day is combined with year/month/date', log.wrap((localLogger) => {\n      const d = {\n        year: 2007,\n        day: 'monday'\n      };\n      const expr = dateTimeExpr(d, true);\n      assert.equal(expr, 'datetime(2007, 0, 1, 0, 0, 0, 0)');\n      assert.equal(localLogger.warns[0], log.message.droppedDay(d));\n    }));\n\n    it('should normalize numeric quarter correctly', () => {\n      const expr = dateTimeExpr({\n        quarter: 2\n      }, true);\n      assert.equal(expr, 'datetime(0, 1*3, 1, 0, 0, 0, 0)');\n    });\n\n    it('should log warning for quarter > 4', log.wrap((localLogger) => {\n      assert.equal(dateTimeExpr({\n        quarter: 5\n      }, true), 'datetime(0, 4*3, 1, 0, 0, 0, 0)');\n      assert.equal(localLogger.warns[0], log.message.invalidTimeUnit('quarter', 5));\n    }));\n\n    it('should throw error for invalid quarter', () => {\n      assert.throws(() => {\n        dateTimeExpr({quarter: 'Q'}, true);\n      }, Error, log.message.invalidTimeUnit('quarter', 'Q'));\n    });\n\n    it('should normalize numeric month correctly', () => {\n      const expr = dateTimeExpr({\n        month: 1\n      }, true);\n      assert.equal(expr, 'datetime(0, 0, 1, 0, 0, 0, 0)');\n    });\n\n    it('should normalize month name correctly', () => {\n      assert.equal(dateTimeExpr({\n        month: 'January'\n      }, true), 'datetime(0, 0, 1, 0, 0, 0, 0)');\n      assert.equal(dateTimeExpr({\n        month: 'january'\n      }, true), 'datetime(0, 0, 1, 0, 0, 0, 0)');\n      assert.equal(dateTimeExpr({\n        month: 'Jan'\n      }, true), 'datetime(0, 0, 1, 0, 0, 0, 0)');\n      assert.equal(dateTimeExpr({\n        month: 'jan'\n      }, true), 'datetime(0, 0, 1, 0, 0, 0, 0)');\n    });\n\n    it('should throw error for invalid month', () => {\n      assert.throws(() => {\n        dateTimeExpr({month: 'J'}, true);\n      }, Error, log.message.invalidTimeUnit('month', 'J'));\n    });\n\n    it('should normalize numeric day (of week) correctly', () => {\n      assert.equal(dateTimeExpr({\n        day: 0\n      }, true), 'datetime(2006, 0, 0+1, 0, 0, 0, 0)');\n      assert.equal(dateTimeExpr({\n        day: 7\n      }, true), 'datetime(2006, 0, 0+1, 0, 0, 0, 0)');\n    });\n\n    it('should normalize day name correctly and use year 2006 to ensure correct', () => {\n      assert.equal(dateTimeExpr({\n        day: 'Sunday'\n      }, true), 'datetime(2006, 0, 0+1, 0, 0, 0, 0)');\n      assert.equal(dateTimeExpr({\n        day: 'sunday'\n      }, true), 'datetime(2006, 0, 0+1, 0, 0, 0, 0)');\n      assert.equal(dateTimeExpr({\n        day: 'Sun'\n      }, true), 'datetime(2006, 0, 0+1, 0, 0, 0, 0)');\n      assert.equal(dateTimeExpr({\n        day: 'sun'\n      }, true), 'datetime(2006, 0, 0+1, 0, 0, 0, 0)');\n    });\n\n    it('should throw error for invalid day', () => {\n      assert.throws(() => {\n        dateTimeExpr({day: 'S'}, true);\n      }, Error, log.message.invalidTimeUnit('day', 'S'));\n    });\n\n    it('should use utc expression if utc is specified', () => {\n      const d = {\n        year: 2007,\n        day: 'monday',\n        utc: true\n      };\n      const expr = dateTimeExpr(d, true);\n      assert.equal(expr, 'utc(2007, 0, 1, 0, 0, 0, 0)');\n    });\n\n    // Note: Other part of coverage handled by timeUnit.fieldExpr's test\n  });\n});\n"]}